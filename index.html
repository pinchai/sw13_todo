<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <title>JS</title>
</head>
<style>
    .box {
        width: 500px;
        height: 500px;
        border-radius: 10px;
        box-shadow: 1px 11px 22px #CCCC;
        margin-top: 10px;
    }

    #todo_list {
        list-style: none;
    }

    #todo_list li {
        padding: 10px;
        text-transform: capitalize;
    }
</style>
<body>
<center>
  <div class="box" id="box">
    <label>Todo: </label>
    <input
      id="todo_input"
      type="text"
      placeholder="Enter your todo"
    >
    <input type="button" value="Add" id="btn_add">
    <hr>
    <ul id="todo_list"></ul>
  </div>
</center>
<script>
    let todo_arr = []
    let todo_list = document.getElementById('todo_list')
    let btn_add = document.getElementById('btn_add')
    let todo_input = document.getElementById('todo_input')
    let status = 'add'
    let global_index = -1
    renderTodoList()

    function renderTodoList() {
        let task_string = ""
        for (let item of todo_arr) {
            let task_name = `<strong>${item.id}.</strong><span>${item.task}</span>`
            let btn_done = `<input type="button" value="âœ…" onclick="makeItDone(${item.id})">`
            if (item.isDone) {
                task_name = `<del>${item.id}.</del><del>${item.task}</del>`
                btn_done = ""
            }

            task_string += `
             <li>
              ${task_name}
              ${btn_done}
              <input type="button" value="ðŸ“" onclick="getEdit(${item.id})">
              <input type="button" value="âŒ" onclick="deleteTask(${item.id})">
            </li>
          `
        }
        todo_list.innerHTML = task_string
    }

    btn_add.addEventListener('click', function () {
        let todo_text = todo_input.value
        if (status === 'add') {
            todo_arr.push(
                {
                    id: todo_arr.length + 1,
                    task: todo_text,
                    isDone: false
                }
            )
        } else {
            //
            todo_arr[global_index].task = todo_text
        }
        renderTodoList()
        clearForm()
    })

    todo_input.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            btn_add.click()
        }
    })

    function deleteTask(id) {
        console.log(id)
        let index = -1
        for (let i = 0; i < todo_arr.length; i++) {
            if (todo_arr[i].id === id) {
                index = i
            }
        }

        Swal.fire({
            title: "Are you sure?",
            text: "You won't be able to revert this!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#3085d6",
            cancelButtonColor: "#d33",
            confirmButtonText: "Yes, delete it!"
        }).then((result) => {
            if (result.isConfirmed) {
                todo_arr.splice(index, 1)
                renderTodoList()
            }
        });
    }

    function getEdit(id) {
        let index = -1
        for (let i = 0; i < todo_arr.length; i++) {
            if (todo_arr[i].id === id) {
                index = i
            }
        }
        todo_input.value = todo_arr[index].task
        status = 'edit'
        btn_add.value = 'Edit'
        global_index = index
    }

    function makeItDone(id) {
        let index = -1
        for (let i = 0; i < todo_arr.length; i++) {
            if (todo_arr[i].id === id) {
                index = i
            }
        }
        todo_input.value = todo_arr[index].isDone = true
        renderTodoList()
        console.log(todo_arr)
    }

    function clearForm() {
        todo_input.value = ""
        todo_input.focus()
        status = 'add'
        btn_add.value = 'Add'
        global_index = -1
    }
</script>
</body>
</html>
